CREATE DATABASE IF NOT EXISTS exam_practice 
DEFAULT CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;

USE exam_practice;

CREATE TABLE question (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    type VARCHAR(20) NOT NULL COMMENT '题型：choice(选择题)/judge(判断题)',
    subject VARCHAR(50) DEFAULT '未分类' COMMENT '科目',
    content TEXT NOT NULL COMMENT '题目内容',
    options JSON COMMENT '选项（选择题用，格式：["A:选项1","B:选项2","C:选项3","D:选项4"]）',
    answer VARCHAR(200) NOT NULL COMMENT '答案',
    analysis TEXT COMMENT '答案解析',
    difficulty VARCHAR(10) DEFAULT 'medium' COMMENT '难度：easy/medium/hard',
    is_marked BOOLEAN DEFAULT FALSE COMMENT '是否标记为重点',
    wrong_count INT DEFAULT 0 COMMENT '做错次数',
    practice_count INT DEFAULT 0 COMMENT '练习次数',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_type (type),
    INDEX idx_subject (subject),
    INDEX idx_difficulty (difficulty)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='题目表';



CREATE TABLE practice_record (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    question_id BIGINT NOT NULL COMMENT '题目ID',
    user_answer TEXT COMMENT '用户答案',
    is_correct BOOLEAN NOT NULL COMMENT '是否正确',
    cost_time INT COMMENT '答题耗时（秒）',
    practice_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '练习时间',
    INDEX idx_question (question_id),
    INDEX idx_correct (is_correct),
    INDEX idx_time (practice_time)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='练习记录表';


CREATE TABLE subject (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    name VARCHAR(50) NOT NULL UNIQUE COMMENT '科目名称',
    question_count INT DEFAULT 0 COMMENT '题目数量',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    INDEX idx_name (name)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='科目表';